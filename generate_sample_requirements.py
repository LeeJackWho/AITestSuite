import pandas as pd
import os

def generate_sample_requirements():
    """生成示例需求Excel文件"""
    try:
        # 示例需求数据
        sample_data = [
            {
                "需求分类": "功能需求",
                "父需求": "",
                "标题": "用户登录功能",
                "详细描述": "系统应支持用户通过用户名和密码进行登录，登录成功后跳转到首页。",
                "优先级": "高",
                "迭代": "迭代27",
                "处理人": "测试团队"
            },
            {
                "需求分类": "功能需求",
                "父需求": "",
                "标题": "用户注册功能",
                "详细描述": "系统应支持用户注册功能，包括用户名、密码、邮箱和手机号验证。",
                "优先级": "高",
                "迭代": "迭代27",
                "处理人": "测试团队"
            },
            {
                "需求分类": "功能需求",
                "父需求": "",
                "标题": "找回密码功能",
                "详细描述": "系统应支持用户找回密码功能，通过邮箱验证码重置密码。",
                "优先级": "中",
                "迭代": "迭代27",
                "处理人": "测试团队"
            },
            {
                "需求分类": "功能需求",
                "父需求": "",
                "标题": "修改个人信息",
                "详细描述": "系统应支持用户修改个人信息，包括昵称、头像和联系方式。",
                "优先级": "中",
                "迭代": "迭代27",
                "处理人": "测试团队"
            },
            {
                "需求分类": "功能需求",
                "父需求": "",
                "标题": "用户管理功能",
                "详细描述": "系统应支持管理员查看所有用户列表，并可以禁用或删除用户。",
                "优先级": "低",
                "迭代": "迭代27",
                "处理人": "测试团队"
            }
        ]
        
        # 创建DataFrame
        df = pd.DataFrame(sample_data)
        
        # 确保目录存在
        os.makedirs("./需求文档", exist_ok=True)
        
        # 保存到Excel
        output_file = "./需求文档/sample_requirements.xlsx"
        df.to_excel(output_file, index=False)
        
        print(f"已生成示例需求文件: {output_file}")
        return output_file
    except Exception as e:
        print(f"生成示例需求文件失败: {str(e)}")
        return None

if __name__ == "__main__":
    generate_sample_requirements()
